{"componentChunkName":"component---src-templates-tutorial-tsx","path":"/fi/developers/tutorials/short-abi/","result":{"data":{"siteData":{"siteMetadata":{"editContentUrl":"https://github.com/ethereum/ethereum-org-website/tree/dev/"}},"pageData":{"fields":{"slug":"/en/developers/tutorials/short-abi/","readingTime":{"minutes":15.1}},"frontmatter":{"title":"Short ABIs for Calldata Optimization","description":"Optimizing smart contracts for Optimistic Rollups","lang":"en","tags":["layer 2","optimism"],"author":"Ori Pomerantz","source":null,"sourceUrl":null,"skill":"intermediate","published":"2022-04-01T00:00:00.000Z","sidebarDepth":null,"address":null,"isOutdated":null,"postMergeBannerTranslation":null,"hideEditButton":null},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Short ABIs for Calldata Optimization\",\n  \"description\": \"Optimizing smart contracts for Optimistic Rollups\",\n  \"author\": \"Ori Pomerantz\",\n  \"lang\": \"en\",\n  \"tags\": [\"layer 2\", \"optimism\"],\n  \"skill\": \"intermediate\",\n  \"published\": \"2022-04-01T00:00:00.000Z\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"introduction\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#introduction\",\n    \"aria-label\": \"introduction permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Introduction\"), mdx(\"p\", null, \"In this article, you learn about \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/developers/docs/scaling/optimistic-rollups\"\n  }, \"optimistic rollups\"), \", the cost of transactions on them, and how that different cost structure requires us to optimize for different things than on the Ethereum Mainnet.\\nYou also learn how to implement this optimization.\"), mdx(\"h3\", {\n    \"id\": \"full-disclosure\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#full-disclosure\",\n    \"aria-label\": \"full disclosure permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Full disclosure\"), mdx(\"p\", null, \"I'm a full time \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.optimism.io/\"\n  }, \"Optimism\"), \" employee, so examples in this article will run on Optimism.\\nHowever, the technique explained here should work just as well for other rollups.\"), mdx(\"h3\", {\n    \"id\": \"terminology\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#terminology\",\n    \"aria-label\": \"terminology permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Terminology\"), mdx(\"p\", null, \"When discussing rollups, the term 'layer 1' (L1) is used for Mainnet, the production Ethereum network.\\nThe term 'layer 2' (L2) is used for the rollup or any other system that relies on L1 for security but does most of its processing off-chain.\"), mdx(\"h2\", {\n    \"id\": \"how-can-we-further-reduce-the-cost-of-L2-transactions\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#how-can-we-further-reduce-the-cost-of-L2-transactions\",\n    \"aria-label\": \"how can we further reduce the cost of L2 transactions permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"How can we further reduce the cost of L2 transactions?\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/developers/docs/scaling/optimistic-rollups\"\n  }, \"Optimistic rollups\"), \" have to preserve a record of every historical transaction so that anybody will be able to go through them and verify that the current state is correct.\\nThe cheapest way to get data into the Ethereum Mainnet is to write it as calldata.\\nThis solution was chosen by both \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://help.optimism.io/hc/en-us/articles/4413163242779-What-is-a-rollup-\"\n  }, \"Optimism\"), \" and \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developer.offchainlabs.com/docs/rollup_basics#intro-to-rollups\"\n  }, \"Arbitrum\"), \".\"), mdx(\"h3\", {\n    \"id\": \"cost-of-l2-transactions\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#cost-of-l2-transactions\",\n    \"aria-label\": \"cost of l2 transactions permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Cost of L2 transactions\"), mdx(\"p\", null, \"The cost of L2 transactions is composed of two components:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"L2 processing, which is usually extremely cheap\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"L1 storage, which is tied to Mainnet gas costs\")), mdx(\"p\", null, \"As I'm writing this, on Optimism the cost of L2 gas is 0.001 \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://ethereum.org/en/developers/docs/gas/#pre-london\"\n  }, \"Gwei\"), \".\\nThe cost of L1 gas, on the other hand, is approximately 40 gwei.\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://public-grafana.optimism.io/d/9hkhMxn7z/public-dashboard?orgId=1&refresh=5m\"\n  }, \"You can see the current prices here\"), \".\"), mdx(\"p\", null, \"A byte of calldata costs either 4 gas (if it is zero) or 16 gas (if it is any other value).\\nOne of the most expensive operations on the EVM is writing to storage.\\nThe maximum cost of writing a 32-byte word to storage on L2 is 22100 gas. Currently, this is 22.1 gwei.\\nSo if we can save a single zero byte of calldata, we'll be able to write about 200 bytes to storage and still come out ahead.\"), mdx(\"h3\", {\n    \"id\": \"the-abi\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#the-abi\",\n    \"aria-label\": \"the abi permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"The ABI\"), mdx(\"p\", null, \"The vast majority of transactions access a contract from an externally-owned account.\\nMost contracts are written in Solidity and interpret their data field per \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.soliditylang.org/en/latest/abi-spec.html#formal-specification-of-the-encoding\"\n  }, \"the application binary interface (ABI)\"), \".\"), mdx(\"p\", null, \"However, the ABI was designed for L1, where a byte of calldata costs approximately the same as four arithmetic operations, not L2 where a byte of calldata costs more than a thousand arithmetic operations.\\nFor example, \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/0x7ce4c144ebfce157b4de99d8ad53a352ae91b57b3fa06d8a1c79439df6bfa998\"\n  }, \"here is an ERC-20 transfer transaction\"), \".\\nThe calldata is divided like this:\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Section\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"Length\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"Bytes\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"Wasted bytes\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"Wasted gas\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"Necessary bytes\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"Necessary gas\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Function selector\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"4\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"0-3\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"3\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"48\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"1\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"16\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Zeroes\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"12\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"4-15\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"12\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"48\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"0\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"0\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Destination address\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"20\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"16-35\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"0\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"0\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"20\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"320\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Amount\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"32\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"36-67\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"17\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"64\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"15\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"240\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Total\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"68\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"160\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"576\")))), mdx(\"p\", null, \"Explanation:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Function selector\"), \": The contract has less than 256 functions, so we can distinguish them with a single byte.\\nThese bytes are typically non-zero and therefore \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://eips.ethereum.org/EIPS/eip-2028\"\n  }, \"cost sixteen gas\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Zeroes\"), \": These bytes are always zero because a twenty-byte address does not require a thirty-two-byte word to hold it.\\nBytes that hold zero cost four gas (\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://ethereum.github.io/yellowpaper/paper.pdf\"\n  }, \"see the yellow paper\"), \", Appendix G,\\np. 27, the value for \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"G\"), mdx(\"sub\", null, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"txdatazero\")), \").\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Amount\"), \": If we assume that in this contract \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"decimals\"), \" is eighteen (the normal value) and the maximum amount of tokens we transfer will be 10\", mdx(\"sup\", null, \"18\"), \", we get a maximum amount of 10\", mdx(\"sup\", null, \"36\"), \".\\n256\", mdx(\"sup\", null, \"15\"), \" \", \">\", \" 10\", mdx(\"sup\", null, \"36\"), \", so fifteen bytes are enough.\")), mdx(\"p\", null, \"A waste of 160 gas on L1 is normally negligible. A transaction costs at least \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://yakkomajuri.medium.com/blockchain-definition-of-the-week-ethereum-gas-2f976af774ed\"\n  }, \"21,000 gas\"), \", so an extra 0.8% doesn't matter.\\nHowever, on L2, things are different. Almost the entire cost of the transaction is writing it to L1.\\nIn addition to the transaction calldata, there are 109 bytes of transaction header (destination address, signature, etc.).\\nThe total cost is therefore \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"109*16+576+160=2480\"), \", and we are wasting about 6.5% of that.\"), mdx(\"h2\", {\n    \"id\": \"reducing-costs-when-you-dont-control-the-destination\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#reducing-costs-when-you-dont-control-the-destination\",\n    \"aria-label\": \"reducing costs when you dont control the destination permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Reducing costs when you don't control the destination\"), mdx(\"p\", null, \"Assuming that you do not have control over the destination contract, you can still use a solution similar to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/qbzzt/ethereum.org-20220330-shortABI\"\n  }, \"this one\"), \".\\nLet's go over the relevant files.\"), mdx(\"h3\", {\n    \"id\": \"tokensol-tokensol\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#tokensol-tokensol\",\n    \"aria-label\": \"tokensol tokensol permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Token.sol {#token.sol}\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/qbzzt/ethereum.org-20220330-shortABI/blob/master/contracts/Token.sol\"\n  }, \"This is the destination contract\"), \".\\nIt is a standard ERC-20 contract, with one additional feature.\\nThis \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"faucet\"), \" function lets any user get some token to use.\\nIt would make a production ERC-20 contract useless, but it makes life easier when an ERC-20 exists only to facilitate testing.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"    /**\\n     * @dev Gives the caller 1000 tokens to play with\\n     */\\n    function faucet() external {\\n        _mint(msg.sender, 1000);\\n    }   // function faucet\\n\")), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/address/0x950c753c0edbde44a74d3793db738a318e9c8ce8\"\n  }, \"You can see an example of this contract being deployed here\"), \".\"), mdx(\"h3\", {\n    \"id\": \"calldatainterpretersol-calldatainterpretersol\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#calldatainterpretersol-calldatainterpretersol\",\n    \"aria-label\": \"calldatainterpretersol calldatainterpretersol permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"CalldataInterpreter.sol {#calldatainterpreter.sol}\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/qbzzt/ethereum.org-20220330-shortABI/blob/master/contracts/CalldataInterpreter.sol\"\n  }, \"This is the contract that transactions are supposed to call with shorter calldata\"), \".\\nLet's go over it line by line.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"//SPDX-License-Identifier: Unlicense\\npragma solidity ^0.8.0;\\n\\n\\nimport { OrisUselessToken } from \\\"./Token.sol\\\";\\n\")), mdx(\"p\", null, \"We need the token function to know how to call it.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"contract CalldataInterpreter {\\n\\n    OrisUselessToken public immutable token;\\n\")), mdx(\"p\", null, \"The address of the token for which we are a proxy.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"\\n    /**\\n     * @dev Specify the token address\\n     * @param tokenAddr_ ERC-20 contract address\\n     */\\n    constructor(\\n        address tokenAddr_\\n    )  {\\n        token = OrisUselessToken(tokenAddr_);\\n    }   // constructor\\n\")), mdx(\"p\", null, \"The token address is the only parameter we need to specify.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"    function calldataVal(uint startByte, uint length)\\n        private pure returns (uint) {\\n\")), mdx(\"p\", null, \"Read a value from the calldata.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"        uint _retVal;\\n\\n        require(length < 0x21,\\n            \\\"calldataVal length limit is 32 bytes\\\");\\n\\n        require(length + startByte <= msg.data.length,\\n            \\\"calldataVal trying to read beyond calldatasize\\\");\\n\")), mdx(\"p\", null, \"We are going to load a single 32-byte (256-bit) word to memory and remove the bytes that aren't part of the field we want.\\nThis algorithm doesn't work for values longer than 32 bytes, and of course we can't read past the end of the calldata.\\nOn L1 it might be necessary to skip these tests to save on gas, but on L2 gas is extremely cheap, which enables whatever sanity checks we can think of.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"        assembly {\\n            _retVal := calldataload(startByte)\\n        }\\n\")), mdx(\"p\", null, \"We could have copied the data from the call to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fallback()\"), \" (see below), but it is easier to use \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.soliditylang.org/en/v0.8.12/yul.html\"\n  }, \"Yul\"), \", the assembly language of the EVM.\"), mdx(\"p\", null, \"Here we use \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.evm.codes/#35\"\n  }, \"the CALLDATALOAD opcode\"), \" to read bytes \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"startByte\"), \" to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"startByte+31\"), \" into the stack.\\nIn general, the syntax of an opcode in Yul is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"<opcode name>(<first stack value, if any>,<second stack value, if any>...)\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"\\n        _retVal = _retVal >> (256-length*8);\\n\")), mdx(\"p\", null, \"Only the most significant \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"length\"), \" bytes are part of the field, so we \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://en.wikipedia.org/wiki/Logical_shift\"\n  }, \"right-shift\"), \" to get rid of the other values.\\nThis has the added advantage of moving the value to the right of the field, so it is the value itself rather than the value times 256\", mdx(\"sup\", null, \"something\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"\\n        return _retVal;\\n    }\\n\\n\\n    fallback() external {\\n\")), mdx(\"p\", null, \"When a call to a Solidity contract does not match any of the function signatures, it calls \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.soliditylang.org/en/v0.8.12/contracts.html#fallback-function\"\n  }, \"the \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"fallback()\"), \" function\"), \" (assuming there is one).\\nIn the case of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"CalldataInterpreter\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"any\"), \" call gets here because there are no other \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"external\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"public\"), \" functions.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"        uint _func;\\n\\n        _func = calldataVal(0, 1);\\n\")), mdx(\"p\", null, \"Read the first byte of the calldata, which tells us the function.\\nThere are two reasons why a function would not be available here:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Functions that are \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"pure\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"view\"), \" don't change the state and don't cost gas (when called off-chain).\\nIt makes no sense to try to reduce their gas cost.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Functions that rely on \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://docs.soliditylang.org/en/v0.8.12/units-and-global-variables.html#block-and-transaction-properties\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"msg.sender\")), \".\\nThe value of \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"msg.sender\"), \" is going to be \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"CalldataInterpreter\"), \"'s address, not the caller.\")), mdx(\"p\", null, \"Unfortunately, \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://eips.ethereum.org/EIPS/eip-20\"\n  }, \"looking at the ERC-20 specifications\"), \", this leaves only one function, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"transfer\"), \".\\nThis leaves us with only two functions: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"transfer\"), \" (because we can call \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"transferFrom\"), \") and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"faucet\"), \" (because we can transfer the tokens back to whoever called us).\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"\\n        // Call the state changing methods of token using\\n        // information from the calldata\\n\\n        // faucet\\n        if (_func == 1) {\\n\")), mdx(\"p\", null, \"A call to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"faucet()\"), \", which doesn't have parameters.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"            token.faucet();\\n            token.transfer(msg.sender,\\n                token.balanceOf(address(this)));\\n        }\\n\")), mdx(\"p\", null, \"After we call \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"token.faucet()\"), \" we get tokens. However, as the proxy contract, we do not \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"need\"), \" tokens.\\nThe EOA (externally owned account) or contract that called us does.\\nSo we transfer all of our tokens to whoever called us.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"        // transfer (assume we have an allowance for it)\\n        if (_func == 2) {\\n\")), mdx(\"p\", null, \"Transferring tokens requires two parameters: the destination address and the amount.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"            token.transferFrom(\\n                msg.sender,\\n\")), mdx(\"p\", null, \"We only allow callers to transfer tokens they own\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"                address(uint160(calldataVal(1, 20))),\\n\")), mdx(\"p\", null, \"The destination address starts at byte #1 (byte #0 is the function).\\nAs an address, it is 20-bytes long.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"                calldataVal(21, 2)\\n\")), mdx(\"p\", null, \"For this particular contract we assume that the maximum number of tokens anybody would want to transfer fits in two bytes (less than 65536).\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"            );\\n        }\\n\")), mdx(\"p\", null, \"Overall, a transfer takes 35 bytes of calldata:\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Section\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"Length\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"Bytes\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Function selector\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"1\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"0\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Destination address\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"32\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"1-32\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Amount\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"2\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": \"right\"\n  }, \"33-34\")))), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"    }   // fallback\\n\\n}       // contract CalldataInterpreter\\n\")), mdx(\"h3\", {\n    \"id\": \"testjs-testjs\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#testjs-testjs\",\n    \"aria-label\": \"testjs testjs permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"test.js {#test.js}\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/qbzzt/ethereum.org-20220330-shortABI/blob/master/test/test.js\"\n  }, \"This JavaScript unit test\"), \" shows us how to use this mechanism (and how to verify it works correctly).\\nI am going to assume you understand \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.chaijs.com/\"\n  }, \"chai\"), \" and \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.ethers.io/v5/\"\n  }, \"ethers\"), \" and only explain the parts that specifically apply to the contract.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"const { expect } = require(\\\"chai\\\");\\n\\ndescribe(\\\"CalldataInterpreter\\\", function () {\\n  it(\\\"Should let us use tokens\\\", async function () {\\n    const Token = await ethers.getContractFactory(\\\"OrisUselessToken\\\")\\n    const token = await Token.deploy()\\n    await token.deployed()\\n    console.log(\\\"Token addr:\\\", token.address)\\n\\n    const Cdi = await ethers.getContractFactory(\\\"CalldataInterpreter\\\")\\n    const cdi = await Cdi.deploy(token.address)\\n    await cdi.deployed()\\n    console.log(\\\"CalldataInterpreter addr:\\\", cdi.address)\\n\\n    const signer = await ethers.getSigner()\\n\")), mdx(\"p\", null, \"We start by deploying both contracts.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"    // Get tokens to play with\\n    const faucetTx = {\\n\")), mdx(\"p\", null, \"We can't use the high-level functions we'd normally use (such as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"token.faucet()\"), \") to create transactions, because we do not follow the ABI.\\nInstead, we have to build the transaction ourselves and then send it.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"      to: cdi.address,\\n      data: \\\"0x01\\\"\\n\")), mdx(\"p\", null, \"There are two parameters we need to provide for the transaction:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"to\"), \", the destination address.\\nThis is the calldata interpreter contract.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"data\"), \", the calldata to send.\\nIn the case of a faucet call, the data is a single byte, \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"0x01\"), \".\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"\\n    }\\n    await (await signer.sendTransaction(faucetTx)).wait()\\n\")), mdx(\"p\", null, \"We call \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.ethers.io/v5/api/signer/#Signer-sendTransaction\"\n  }, \"the signer's \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"sendTransaction\"), \" method\"), \" because we already specified the destination (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"faucetTx.to\"), \") and we need the transaction to be signed.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"// Check the faucet provides the tokens correctly\\nexpect(await token.balanceOf(signer.address)).to.equal(1000)\\n\")), mdx(\"p\", null, \"Here we verify the balance.\\nThere is no need to save gas on \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"view\"), \" functions, so we just run them normally.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"// Give the CDI an allowance (approvals cannot be proxied)\\nconst approveTX = await token.approve(cdi.address, 10000)\\nawait approveTX.wait()\\nexpect(await token.allowance(signer.address, cdi.address)).to.equal(10000)\\n\")), mdx(\"p\", null, \"Give the calldata interpreter an allowance to be able to do transfers.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"// Transfer tokens\\nconst destAddr = \\\"0xf5a6ead936fb47f342bb63e676479bddf26ebe1d\\\"\\nconst transferTx = {\\n  to: cdi.address,\\n  data: \\\"0x02\\\" + destAddr.slice(2, 42) + \\\"0100\\\",\\n}\\n\")), mdx(\"p\", null, \"Create a transfer transaction. The first byte is \\\"0x02\\\", followed by the destination address, and finally the amount (0x0100, which is 256 in decimal).\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"    await (await signer.sendTransaction(transferTx)).wait()\\n\\n    // Check that we have 256 tokens less\\n    expect (await token.balanceOf(signer.address)).to.equal(1000-256)\\n\\n    // And that our destination got them\\n    expect (await token.balanceOf(destAddr)).to.equal(256)\\n  })    // it\\n})      // describe\\n\")), mdx(\"h3\", {\n    \"id\": \"example\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#example\",\n    \"aria-label\": \"example permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Example\"), mdx(\"p\", null, \"If you want to see these files in action without running them yourself, follow these links:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1410744\"\n  }, \"Deployment of \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"OrisUselessToken\")), \" to \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/address/0x950c753c0edbde44a74d3793db738a318e9c8ce8\"\n  }, \"address \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"0x950c753c0edbde44a74d3793db738a318e9c8ce8\")), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1410745\"\n  }, \"Deployment of \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"CalldataInterpreter\")), \" to \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/address/0x16617fea670aefe3b9051096c0eb4aeb4b3a5f55\"\n  }, \"address \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"0x16617fea670aefe3b9051096c0eb4aeb4b3a5f55\")), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1410746\"\n  }, \"Call to \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"faucet()\")), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1410747\"\n  }, \"Call to \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"OrisUselessToken.approve()\")), \".\\nThis call has to go directly to the token contract because the processing relies on \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"msg.sender\"), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1410748\"\n  }, \"Call to \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"transfer()\")), \".\")), mdx(\"h2\", {\n    \"id\": \"reducing-the-cost-when-you-do-control-the-destination-contract\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#reducing-the-cost-when-you-do-control-the-destination-contract\",\n    \"aria-label\": \"reducing the cost when you do control the destination contract permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Reducing the cost when you do control the destination contract\"), mdx(\"p\", null, \"If you do have control over the destination contract you can create functions that bypass the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"msg.sender\"), \" checks because they trust the calldata interpreter.\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/qbzzt/ethereum.org-20220330-shortABI/tree/control-contract\"\n  }, \"You can see an example of how this works here, in the \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"control-contract\"), \" branch\"), \".\"), mdx(\"p\", null, \"If the contract were responding only to external transactions, we could get by with having just one contract.\\nHowever, that would break \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/developers/docs/smart-contracts/composability/\"\n  }, \"composability\"), \".\\nIt is much better to have a contract that responds to normal ERC-20 calls, and another contract that responds to transactions with short call data.\"), mdx(\"h3\", {\n    \"id\": \"tokensol-tokensol-2\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#tokensol-tokensol-2\",\n    \"aria-label\": \"tokensol tokensol 2 permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Token.sol {#token.sol-2}\"), mdx(\"p\", null, \"In this example we can modify \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Token.sol\"), \".\\nThis lets us have a number of functions that only the proxy may call.\\nHere are the new parts:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"    // The only address allowed to specify the CalldataInterpreter address\\n    address owner;\\n\\n    // The CalldataInterpreter address\\n    address proxy = address(0);\\n\")), mdx(\"p\", null, \"The ERC-20 contract needs to know the identity of the authorized proxy.\\nHowever, we cannot set this variable in the constructor, because we don't know the value yet.\\nThis contract is instantiated first because the proxy expects the token's address in its constructor.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"    /**\\n     * @dev Calls the ERC20 constructor.\\n     */\\n    constructor(\\n    ) ERC20(\\\"Oris useless token-2\\\", \\\"OUT-2\\\") {\\n        owner = msg.sender;\\n    }\\n\")), mdx(\"p\", null, \"The address of the creator (called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"owner\"), \") is stored here because that is the only address allowed to set the proxy.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"    /**\\n     * @dev set the address for the proxy (the CalldataInterpreter).\\n     * Can only be called once by the owner\\n     */\\n    function setProxy(address _proxy) external {\\n        require(msg.sender == owner, \\\"Can only be called by owner\\\");\\n        require(proxy == address(0), \\\"Proxy is already set\\\");\\n\\n        proxy = _proxy;\\n    }    // function setProxy\\n\")), mdx(\"p\", null, \"The proxy has privileged access, because it can bypass security checks.\\nTo make sure we can trust the proxy we only let \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"owner\"), \" call this function, and only once.\\nOnce \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"proxy\"), \" has a real value (not zero), that value cannot change, so even if the owner decides to become rogue, or the mnemonic for it is revealed, we are still safe.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"    /**\\n     * @dev Some functions may only be called by the proxy.\\n     */\\n    modifier onlyProxy {\\n\")), mdx(\"p\", null, \"This is a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.tutorialspoint.com/solidity/solidity_function_modifiers.htm\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"modifier\"), \" function\"), \", it modifies the way other functions work.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"      require(msg.sender == proxy);\\n\")), mdx(\"p\", null, \"First, verify we got called by the proxy and nobody else.\\nIf not, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"revert\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"      _;\\n    }\\n\")), mdx(\"p\", null, \"If so, run the function which we modify.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"   /* Functions that allow the proxy to actually proxy for accounts */\\n\\n    function transferProxy(address from, address to, uint256 amount)\\n        public virtual onlyProxy() returns (bool)\\n    {\\n        _transfer(from, to, amount);\\n        return true;\\n    }\\n\\n    function approveProxy(address from, address spender, uint256 amount)\\n        public virtual onlyProxy() returns (bool)\\n    {\\n        _approve(from, spender, amount);\\n        return true;\\n    }\\n\\n    function transferFromProxy(\\n        address spender,\\n        address from,\\n        address to,\\n        uint256 amount\\n    ) public virtual onlyProxy() returns (bool)\\n    {\\n        _spendAllowance(from, spender, amount);\\n        _transfer(from, to, amount);\\n        return true;\\n    }\\n\")), mdx(\"p\", null, \"These are three operations that normally require the message to come directly from the entity transferring tokens or approving an allowance.\\nHere we have a proxy version these operations which:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Is modified by \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"onlyProxy()\"), \" so nobody else is allowed to control them.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Gets the address that would normally be \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"msg.sender\"), \" as an extra parameter.\")), mdx(\"h3\", {\n    \"id\": \"calldatainterpretersol-calldatainterpretersol-2\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#calldatainterpretersol-calldatainterpretersol-2\",\n    \"aria-label\": \"calldatainterpretersol calldatainterpretersol 2 permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"CalldataInterpreter.sol {#calldatainterpreter.sol-2}\"), mdx(\"p\", null, \"The calldata interpreter is nearly identical to the one above, except that the proxied functions receive a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"msg.sender\"), \" parameter and there is no need for an allowance for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"transfer\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"        // transfer (no need for allowance)\\n        if (_func == 2) {\\n            token.transferProxy(\\n                msg.sender,\\n                address(uint160(calldataVal(1, 20))),\\n                calldataVal(21, 2)\\n            );\\n        }\\n\\n        // approve\\n        if (_func == 3) {\\n            token.approveProxy(\\n                msg.sender,\\n                address(uint160(calldataVal(1, 20))),\\n                calldataVal(21, 2)\\n            );\\n        }\\n\\n        // transferFrom\\n        if (_func == 4) {\\n            token.transferFromProxy(\\n                msg.sender,\\n                address(uint160(calldataVal( 1, 20))),\\n                address(uint160(calldataVal(21, 20))),\\n                calldataVal(41, 2)\\n            );\\n        }\\n\")), mdx(\"h3\", {\n    \"id\": \"testjs-testjs-2\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#testjs-testjs-2\",\n    \"aria-label\": \"testjs testjs 2 permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Test.js {#test.js-2}\"), mdx(\"p\", null, \"There are a few changes between the previous testing code and this one.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"const Cdi = await ethers.getContractFactory(\\\"CalldataInterpreter\\\")\\nconst cdi = await Cdi.deploy(token.address)\\nawait cdi.deployed()\\nawait token.setProxy(cdi.address)\\n\")), mdx(\"p\", null, \"We need to tell the ERC-20 contract which proxy to trust\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"console.log(\\\"CalldataInterpreter addr:\\\", cdi.address)\\n\\n// Need two signers to verify allowances\\nconst signers = await ethers.getSigners()\\nconst signer = signers[0]\\nconst poorSigner = signers[1]\\n\")), mdx(\"p\", null, \"To check \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"approve()\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"transferFrom()\"), \" we need a second signer.\\nWe call it \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"poorSigner\"), \" because it does not get any of our tokens (it does need to have ETH, of course).\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"// Transfer tokens\\nconst destAddr = \\\"0xf5a6ead936fb47f342bb63e676479bddf26ebe1d\\\"\\nconst transferTx = {\\n  to: cdi.address,\\n  data: \\\"0x02\\\" + destAddr.slice(2, 42) + \\\"0100\\\",\\n}\\nawait (await signer.sendTransaction(transferTx)).wait()\\n\")), mdx(\"p\", null, \"Because the ERC-20 contract trusts the proxy (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"cdi\"), \"), we don't need an allowance to relay transfers.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"// approval and transferFrom\\nconst approveTx = {\\n  to: cdi.address,\\n  data: \\\"0x03\\\" + poorSigner.address.slice(2, 42) + \\\"00FF\\\",\\n}\\nawait (await signer.sendTransaction(approveTx)).wait()\\n\\nconst destAddr2 = \\\"0xE1165C689C0c3e9642cA7606F5287e708d846206\\\"\\n\\nconst transferFromTx = {\\n  to: cdi.address,\\n  data: \\\"0x04\\\" + signer.address.slice(2, 42) + destAddr2.slice(2, 42) + \\\"00FF\\\",\\n}\\nawait (await poorSigner.sendTransaction(transferFromTx)).wait()\\n\\n// Check the approve / transferFrom combo was done correctly\\nexpect(await token.balanceOf(destAddr2)).to.equal(255)\\n\")), mdx(\"p\", null, \"Test the two new functions.\\nNote that \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"transferFromTx\"), \" requires two address parameters: the giver of the allowance and the receiver.\"), mdx(\"h3\", {\n    \"id\": \"example-2\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#example-2\",\n    \"aria-label\": \"example 2 permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Example\"), mdx(\"p\", null, \"If you want to see these files in action without running them yourself, follow these links:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1475397\"\n  }, \"Deployment of \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"OrisUselessToken-2\")), \" at address \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/address/0xb47c1f550d8af70b339970c673bbdb2594011696\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"0xb47c1f550d8af70b339970c673bbdb2594011696\")), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1475400\"\n  }, \"Deployment of \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"CalldataInterpreter\")), \" at address \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/address/0x0dccfd03e3aaba2f8c4ea4008487fd0380815892\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"0x0dccfd03e3aaba2f8c4ea4008487fd0380815892\")), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1475402\"\n  }, \"Call to \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"setProxy()\")), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1475409\"\n  }, \"Call to \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"faucet()\")), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1475416\"\n  }, \"Call to \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"transferProxy()\")), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1475419\"\n  }, \"Call to \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"approveProxy()\")), \".\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://kovan-optimistic.etherscan.io/tx/1475421\"\n  }, \"Call to \", mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"transferFromProxy()\")), \".\\nNote that this call comes from a different address than the other ones, \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"poorSigner\"), \" instead of \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"signer\"), \".\")), mdx(\"h2\", {\n    \"id\": \"conclusion\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#conclusion\",\n    \"aria-label\": \"conclusion permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Conclusion\"), mdx(\"p\", null, \"Both \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://medium.com/ethereum-optimism/the-road-to-sub-dollar-transactions-part-2-compression-edition-6bb2890e3e92\"\n  }, \"Optimism\"), \" and \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developer.offchainlabs.com/docs/special_features\"\n  }, \"Arbitrum\"), \" are looking for ways to reduce the size of the calldata written to L1 and therefore the cost of transactions.\\nHowever, as infrastructure providers looking for generic solutions, our abilities are limited.\\nAs the dapp developer, you have application-specific knowledge, which lets you optimize your calldata much better than we could in a generic solution.\\nHopefully, this article helps you find the ideal solution for your needs.\"));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#introduction-introduction","title":"Introduction {#introduction}","items":[{"url":"#full-disclosure-full-disclosure","title":"Full disclosure {#full-disclosure}"},{"url":"#terminology-terminology","title":"Terminology {#terminology}"}]},{"url":"#how-can-we-further-reduce-the-cost-of-l2-transactions-how-can-we-further-reduce-the-cost-of-l2-transactions","title":"How can we further reduce the cost of L2 transactions? {#how-can-we-further-reduce-the-cost-of-L2-transactions}","items":[{"url":"#cost-of-l2-transactions-cost-of-l2-transactions","title":"Cost of L2 transactions {#cost-of-l2-transactions}"},{"url":"#the-abi-the-abi","title":"The ABI {#the-abi}"}]},{"url":"#reducing-costs-when-you-dont-control-the-destination-reducing-costs-when-you-dont-control-the-destination","title":"Reducing costs when you don't control the destination {#reducing-costs-when-you-dont-control-the-destination}","items":[{"url":"#tokensol-tokensol","title":"Token.sol {#token.sol}"},{"url":"#calldatainterpretersol-calldatainterpretersol","title":"CalldataInterpreter.sol {#calldatainterpreter.sol}"},{"url":"#testjs-testjs","title":"test.js {#test.js}"},{"url":"#example-example","title":"Example {#example}"}]},{"url":"#reducing-the-cost-when-you-do-control-the-destination-contract-reducing-the-cost-when-you-do-control-the-destination-contract","title":"Reducing the cost when you do control the destination contract {#reducing-the-cost-when-you-do-control-the-destination-contract}","items":[{"url":"#tokensol-tokensol-2","title":"Token.sol {#token.sol-2}"},{"url":"#calldatainterpretersol-calldatainterpretersol-2","title":"CalldataInterpreter.sol {#calldatainterpreter.sol-2}"},{"url":"#testjs-testjs-2","title":"Test.js {#test.js-2}"},{"url":"#example-example-2","title":"Example {#example-2}"}]},{"url":"#conclusion-conclusion","title":"Conclusion {#conclusion}"}]}}},"pageContext":{"language":"fi","slug":"/fi/developers/tutorials/short-abi/","ignoreTranslationBanner":false,"isLegal":false,"isOutdated":false,"isContentEnglish":true,"relativePath":"src/content/developers/tutorials/short-abi/index.md","locale":"fi","hrefLang":"fi","originalPath":"/developers/tutorials/short-abi/","dateFormat":"MM/DD/YYYY"}},"staticQueryHashes":["1239077767","3003422828","3280999885","446219633"],"slicesMap":{}}